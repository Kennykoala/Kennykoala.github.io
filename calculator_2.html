<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="https://kit.fontawesome.com/60b6dc290f.js" crossorigin="anonymous"></script>

    <title>熱量計算器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .input_result {
            width: 350px;
            font-size: 36px;
            height: 70px;
            text-align: right;
            overflow: hidden;
            white-space: nowrap;
            /*color: #fff;*/
            color: black;
            border: 1px solid black;
        }

        /* #input-num {
            width: 200px;
            height: 50px;
            border: 1px solid black;
            margin: auto;
            margin-bottom: 10px;
        }

        .showNum {
            justify-content: center;
        } */

        h1 {
            text-align: center;
            padding: 20px 0;
        }

        .info {
            width: 115px;
        }

        .male,
        .female {
            padding: 10px 8px;
        }

        .sport {
            padding-left: 125px;
        }

        .editable {
            font-size: 8px;
            vertical-align: middle;
            cursor: pointer;
        }
    </style>

</head>

<body>
    <h1>熱量計算器</h1>

    <div class="container">
        <div class="row  pb-2">
            <div class="show-hint">
                步驟一：選擇性別
            </div>
            <div class="col-auto info">
                <div class="input_result disPlayDetail"></div>
            </div>
        </div>

        <div class="row pb-2">
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>1</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>2</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>3</button>
                </div>
            </div>
            <div class="col-auto">
                <label for="inputPassword6" class="col-form-label">性別</label>
                <i class="editable edit-gender fas fa-edit text-secondary" hidden></i>
            </div>
            <div class="col-auto">
                <button type="button" class="btn btn-light male" onclick="buttonclick(1)">男</button>
            </div>
            <div class="col-auto">
                <button type="button" class="btn btn-light female" onclick="buttonclick(2)">女</button>
            </div>
        </div>

        <div class="row  pb-2">
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="d-inline-block btn btn-dark fs-4 btnNum" disabled>4</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>5</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>6</button>
                </div>
            </div>
            <div class="col-auto">
                <label for="inputtext" class="col-form-label">年齡</label>
                <i class="editable edit-age fas fa-edit text-secondary" hidden></i>

            </div>
            <div class="col-auto info">
                <input type="text" id="inputtext" class="form-control age" placeholder="歲">
            </div>
        </div>

        <div class="row  pb-2">
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="d-inline-block btn btn-dark fs-4 btnNum" disabled>7</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>8</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>9</button>
                </div>
            </div>
            <div class="col-auto">
                <label for="inputtext" class="col-form-label">身高</label>
                <i class="editable edit-height fas fa-edit text-secondary" hidden></i>
            </div>
            <div class="col-auto info">
                <input type="text" id="inputtext" class="form-control height" placeholder="cm">
            </div>
        </div>

        <div class="row  pb-2">
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" disabled>0</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="btn btn-dark fs-4 btnNum" id="dot" disabled>.</button>
                </div>
            </div>
            <div class="col-auto">
                <div class="btn-item">
                    <button type="button" class="d-inline-block btn btn-dark fs-4" id="check" disabled>確定</button>
                </div>
            </div>
            <div class="col-auto">
                <label for="inputtext" class="col-form-label">體重</label>
                <i class="editable edit-weight fas fa-edit text-secondary" hidden></i>
            </div>
            <div class="col-auto info">
                <input type="text" id="inputtext" class="form-control weight" placeholder="kg">
            </div>
        </div>
        <div class="row  pb-2 sport">
            <div class="col-auto">
                <label for="inputtext" class="col-form-label">一週運動天數</label>
                <i class="editable edit-sport fas fa-edit text-secondary" hidden></i>
            </div>
            <div class="col-auto info">
                <input type="text" id="inputtext" class="form-control sport-day" placeholder="0~7">
            </div>
        </div>
        <div class="input-group mb-3">
            <button class="btn btn-outline-secondary" type="button" id="button-addon1">計算一日所需熱量</button>
            <input type="text" class="form-control" placeholder="" aria-label="Example text with button addon"
                aria-describedby="button-addon1" readonly id="caloriesResult">
        </div>
    </div>



    <script type="text/javascript">

        let result, dot, input_result;
        let btn, smallNum, bigNum, pwd, input, btnNow, male, female;
        let bmrTemp, TDEE;
        // smallNum = document.querySelector('#smNum');
        // bigNum = document.querySelector('#bgNum');
        input_result = document.querySelector('.input_result');
        // input = document.querySelector('#input-num');
        btn = document.querySelectorAll('.btnNum')
        del = document.querySelector('#del')
        chk = document.querySelector('#check')
        dot = document.querySelector('#dot')

        male = document.querySelector('.male')
        female = document.querySelector('.female')
        age = document.querySelector('.age')
        height = document.querySelector('.height')
        weight = document.querySelector('.weight')
        sport_day = document.querySelector('.sport-day')
        btn_compute = document.querySelector('#button-addon1')
        caloriesResult = document.querySelector('#caloriesResult')

        let editGender = document.querySelector('.edit-gender')
        let editAge = document.querySelector('.edit-age')
        let editHeight = document.querySelector('.edit-height')
        let editWeight = document.querySelector('.edit-weight')
        let editSportDay = document.querySelector('.edit-sport')


        hint = document.querySelector('.show-hint')
        let gender = "";
        let ageValue, heightValue, weightValue, sportValue;
        let nowFocusOn = "";
        let checkList = ["年齡", "身高", "體重", "一週運動天數"]


        window.onload = function () {
            age.disabled = true;
            height.disabled = true;
            weight.disabled = true;
            sport_day.disabled = true;
            chk.addEventListener('click', checkClick)

            editGender.addEventListener('click', () => { editContent('性別') });
            editAge.addEventListener('click', () => { editContent('年齡') });
            editHeight.addEventListener('click', () => { editContent('身高') });
            editWeight.addEventListener('click', () => { editContent('體重') });
            editSportDay.addEventListener('click', () => { editContent('一週運動天數') });
            // 數字按鍵eventListener
            for (let i = 0; i < btn.length; i++) {
                btn[i].addEventListener('click', function (event) {
                    btnNow = event.srcElement;
                    input_result.innerText += btnNow.innerText;
                });
            }
        }


        buttonclick = function (t) {
            if (t == 1) {
                male.style.background = "#ff0000";
                female.style.background = "#ffffff";
                gender = "male";
            }
            if (t == 2) {
                female.style.background = "#ff0000";
                male.style.background = "#ffffff";
                gender = "female";
            }
            // chk.addEventListener('click', genderCheck)
            genderCheck();
        }


        checkClick = function () {
            if (!input_result.innerText.trim()) {
                alert('請輸入數字')
                return
            }
            switch (nowFocusOn) {
                case checkList[0]:
                    ageValue = processValue(0)
                    ageCheck()
                    break
                case checkList[1]:
                    heightValue = processValue(1)
                    heightCheck()
                    break
                case checkList[2]:
                    weightValue = processValue(2)
                    weightCheck()
                    break
                case checkList[3]:
                    sportValue = parseInt(processValue(3))
                    dayCheck()
                    break
            }
        }

        processValue = function (nowFocusOnIdx) {
            return parseFloat(input_result.innerText);
        }

        editContent = function (t) {
            input_result.innerText = "";
            male.disabled = true;
            female.disabled = true;
            age.disabled = true;
            height.disabled = true;
            weight.disabled = true;
            sport_day.disabled = true;
            btn[btn.length - 1].disabled = false;
            switch (t) {
                case "性別":
                    chk.disabled = true
                    for (i = 0; i < btn.length; i++) {
                        btn[i].disabled = true  // 關閉數字鍵可點擊的功能
                    }
                    editGender.hidden = true;
                    male.disabled = false;
                    female.disabled = false;
                    male.style.background = "#ffffff";
                    female.style.background = "#ffffff";
                    gender = "";
                    hint.innerText = "修改性別"
                    break
                case "年齡":
                    editAge.hidden = true;
                    age.value = "";
                    age.disabled = false;
                    ageValue = 0;
                    nowFocusOn = "年齡"
                    hint.innerText = "修改年齡"
                    break
                case "身高":
                    editHeight.hidden = true;
                    height.value = "";
                    height.disabled = false;
                    heightValue = 0;
                    nowFocusOn = "身高"
                    hint.innerText = "修改身高"
                    break
                case "體重":
                    editWeight.hidden = true;
                    weight.value = "";
                    weight.disabled = false;
                    weightValue = 0;
                    nowFocusOn = "體重"
                    hint.innerText = "修改體重"
                    break
                case "一週運動天數":
                    editSportDay.hidden = true;
                    sport_day.value = "";
                    sport_day.disabled = false;
                    sportValue = 0;
                    nowFocusOn = "一週運動天數"
                    hint.innerText = "修改一週運動天數"
                    break
            }
        }



        //以下防呆用
        function genderCheck() {
            male.disabled = true;
            female.disabled = true;
            editGender.hidden = null;
            chk.disabled = null
            for (i = 0; i < btn.length; i++) {
                btn[i].disabled = null  // 開啟數字鍵可點擊的功能
            }
            if (age.value) {
                ageCheck();
                return
            }
            age.disabled = false;
            // 輸入年紀
            hint.innerText = "步驟二：輸入年齡"
            // 開啟數字鍵的 eventListener
            nowFocusOn = "年齡"
        }
        function ageCheck() {
            if (ageValue > 200) {
                alert('年齡過大！');
                input_result.innerText = "";
                return
            }
            age.value = ageValue;
            age.disabled = true;
            editAge.hidden = null;
            if (height.value) {
                heightCheck();
                return
            }
            height.disabled = false;
            nowFocusOn = "身高";
            hint.innerText = "步驟三：輸入身高";
            input_result.innerText = "";
        }
        function heightCheck() {
            if (heightValue === 0) {
                alert('身高為0無法計算，請重新輸入！');
                input_result.innerText = "";
                return
            }
            height.value = heightValue;
            height.disabled = true;
            editHeight.hidden = null;
            if (weight.value) {
                weightCheck();
                return
            }
            weight.disabled = false;
            nowFocusOn = "體重";
            hint.innerText = "步驟四：輸入體重"
            input_result.innerText = "";
        }
        function weightCheck() {
            if (weightValue === 0) {
                alert('體重不能為0，請重新輸入');
                input_result.innerText = "";
                return
            }
            weight.value = weightValue;
            weight.disabled = true;
            editWeight.hidden = null;
            if (sport_day.value) {
                dayCheck();
                return
            }
            sport_day.disabled = false;
            btn[btn.length - 1].disabled = true;  // 把小數點關掉
            nowFocusOn = "一週運動天數"
            hint.innerText = "步驟五：輸入一週運動天數"
            input_result.innerText = "";
        }
        function dayCheck() {
            if (sportValue > 7) {
                alert('超過7天，請重新輸入');
                input_result.innerText = "";
                return
            }
            btn[btn.length - 1].disabled = false;  // 把小數點打開
            sport_day.value = sportValue;
            sport_day.disabled = true;
            hint.innerText = "";
            input_result.innerText = "請計算一日所需熱量";
            editSportDay.hidden = null;
        }

        
        // btn_compute.addEventListener("click", function () {
        //     let bmrTemp, TDEE;
        //     if (male) {
        //         bmrTemp = (13.7 * weight.value) + (5.0 * height.value) - (6.8 * age.value) + 66
        //         console.log(male)
        //     } else if (female) {
        //         bmrTemp = (9.6 * weight.value) + (1.8 * height.value) - (4.7 * age.value) + 65
        //     }
        //     console.log(bmrTemp)
        //     switch (sport_day.value) {
        //         case 1:
        //         case 2:
        //         case 3:
        //             TDEE = 1.375 * bmrTemp
        //             caloriesResult.innerText = TDEE
        //             break
        //         case 4:
        //         case 5:
        //             TDEE = 1.55 * bmrTemp
        //             caloriesResult.innerText = TDEE
        //             break
        //         case 6:
        //         case 7:
        //             TDEE = 1.725 * bmrTemp
        //             caloriesResult.innerText = TDEE
        //             break
        //         default:
        //             break

        //     }
            // console.log(sport_day.value)
            // caloriesResult.innerText = TDEE





            // BMR(男)=(13.7×體重(公斤))+(5.0×身高(公分))-(6.8×年齡)+66
            // BMR(女)=(9.6×體重(公斤))+(1.8×身高(公分))-(4.7×年齡)+655

            // 輕量活動：久坐、每周運動1-3天(輕鬆)，TDEE = 1.375 x BMR
            // 中度活動量：站走稍多、每周運動3-5天（中強度），TDEE = 1.55 x BMR
            // 高度活動量：站走為主、每周運動6-7天（高強度），TDEE = 1.725 x BMR
        //})







    </script>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

</body>

</html>